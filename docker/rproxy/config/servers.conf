server {
  #listen 443 ssl;
  listen 8080;
  server_name MACHINE_DOMAIN;
  
  #ssl_certificate /etc/letsencrypt/live/MACHINE_DOMAIN/fullchain.pem;
  #ssl_certificate_key /etc/letsencrypt/live/MACHINE_DOMAIN/privkey.pem;
  #ssl_trusted_certificate /etc/letsencrypt/live/MACHINE_DOMAIN/chain.pem;
  
  access_log /var/log/nginx/access.log;
  error_log /var/log/nginx/error.log;
  
  proxy_connect_timeout 240;
  proxy_send_timeout 600;
  proxy_read_timeout 600;
  send_timeout 600;
    
  
  location /kendo-tournament-frontend {
    return 302 /kendo-tournament-frontend/;
  }
  
  location /flowable-ui/ {
    proxy_pass http://kendo-tournament-frontend:4200/kendo-tournament-frontend/;
    proxy_set_header X-Forwarded-Host $host;
    proxy_set_header X-Forwarded-Server $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  }
  
  location /kendo-tournament-backend {
    return 302 /kendo-tournament-backend/;
  }
  
  location /kendo-tournament-backend/ {
    proxy_pass http://kendo-tournament-backend:8080/kendo-tournament-backend/;
    proxy_set_header X-Forwarded-Host $host;
    proxy_set_header X-Forwarded-Server $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  }

}

server {
  listen       80;
  listen [::]:80;
  server_name MACHINE_DOMAIN;

  location ^~ /.well-known {
      allow all;
      root  /data/letsencrypt/;
  }
  
  # Configure http to redirect to https;
  #location / {
  #  return 301 https://$host$request_uri;
  #}
}